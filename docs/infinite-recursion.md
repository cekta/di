# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —Ä–µ–∫—É—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π?

–≠—Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏ —Å—Å—ã–ª–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞, —Å–æ–∑–¥–∞–≤–∞—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é —Ü–µ–ø–æ—á–∫—É

* **A** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **B**
* **B** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **C**
* **C** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **A** (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –Ω–∞—á–∞–ª—É)

## üéØ –¢–∏–ø–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–•–æ—Ç–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î —Ç–æ–∂–µ –Ω—É–∂–µ–Ω –ª–æ–≥–≥–µ—Ä:

* **–õ–æ–≥–≥–µ—Ä** —Ç—Ä–µ–±—É–µ—Ç **–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î**
* **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î** —Ç—Ä–µ–±—É–µ—Ç **–ª–æ–≥–≥–µ—Ä**

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ç–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–µ.

## üß™ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã

[–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ GitHub](https://github.com/cekta/di-example-usage/commit/f045e39e07dee751ca7ac86a3be523027d1d8f66)

```php
<?php
declare(strict_types=1);

namespace App;

class A {
    public function __construct(public B $b) {}
}

class B {
    public function __construct(public A $a) {}
}

new \Cekta\DI\Configuration(
    containers: [A::class],
)->compile();
```

### üí• –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:

```
php bin/build.php

Fatal error: Uncaught Cekta\DI\Exception\InfiniteRecursion: 
Infinite recursion detected for `App\A`, stack: App\A, App\B
in /app/vendor/cekta/di/src/Compiler.php:99
Stack trace:
...
```

### üîç –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∞?

–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é —Ü–µ–ø–æ—á–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

* `Infinite recursion detected for **App\A**` - –ø—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ **A**
* `stack: App\A, App\B` - –ø–æ–ª–Ω—ã–π –ø—É—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  * –ù–∞—á–∏–Ω–∞–µ–º —Å **A**
  * –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **B**
  * –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ **A** (—Ü–∏–∫–ª –∑–∞–º–∫–Ω—É–ª—Å—è)

---

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ - –º–æ—â–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∞—á–µ –ø—Ä–æ—è–≤–∏–ª–∏—Å—å –±—ã —Ç–æ–ª—å–∫–æ –≤ 
runtime. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∏ –Ω–∞–¥–µ–∂–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.